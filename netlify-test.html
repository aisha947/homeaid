<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Netlify Test - Local Storage Reviews</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        .test-section {
            background: #f5f5f5;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
        }
        .button {
            background: #1976D2;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        .danger {
            background: #f44336;
        }
        .success {
            background: #4caf50;
        }
        .storage-info {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 4px;
            margin: 10px 0;
            font-family: monospace;
            max-height: 300px;
            overflow: auto;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Netlify Test - Local Storage Reviews</h1>
        <p>This page tests the local storage solution for reviews that works on static hosting like Netlify.</p>
        
        <div class="test-section">
            <h2>Local Storage Controls</h2>
            <button class="button" onclick="showLocalStorage()">Show Stored Reviews</button>
            <button class="button success" onclick="addTestReview()">Add Test Review</button>
            <button class="button danger" onclick="clearLocalStorage()">Clear All Reviews</button>
            <div id="storage-info" class="storage-info"></div>
        </div>
        
        <div class="test-section">
            <h2>Add Review Form</h2>
            <form id="testForm">
                <div style="margin-bottom: 10px;">
                    <input type="text" id="testName" placeholder="Name" required style="padding: 8px; width: 300px;">
                </div>
                <div style="margin-bottom: 10px;">
                    <input type="text" id="testService" placeholder="Service" required style="padding: 8px; width: 300px;">
                </div>
                <div style="margin-bottom: 10px;">
                    <textarea id="testMessage" placeholder="Review message" required style="padding: 8px; width: 300px; height: 100px;"></textarea>
                </div>
                <button type="submit" class="button">Add Review</button>
            </form>
        </div>
        
        <div class="test-section">
            <h2>Testimonials</h2>
            <section id="testimonials" class="testimonials">
                <div class="testimonial-container">
                    <div class="testimonial-slider">
                        <div class="testimonial-track">
                            <div class="testimonial-slide">
                                <div class="testimonial-content">
                                    <div class="testimonial-text">
                                        <p>Default review - new reviews will be added from local storage.</p>
                                    </div>
                                    <div class="testimonial-author">
                                        <div class="author-image">
                                            <img src="https://randomuser.me/api/portraits/men/32.jpg" alt="Patient">
                                        </div>
                                        <div class="author-info">
                                            <h4>Default User</h4>
                                            <p>Default Service</p>
                                        </div>
                                        <div class="testimonial-rating">
                                            <i class="fas fa-star"></i>
                                            <i class="fas fa-star"></i>
                                            <i class="fas fa-star"></i>
                                            <i class="fas fa-star"></i>
                                            <i class="fas fa-star"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="testimonial-controls">
                        <button class="prev-testimonial"><i class="fas fa-arrow-circle-left"></i></button>
                        <button class="next-testimonial"><i class="fas fa-arrow-circle-right"></i></button>
                    </div>
                </div>
            </section>
        </div>
    </div>
    
    <script src="script.js"></script>
    <script>
        // Function to show local storage contents
        function showLocalStorage() {
            const reviews = JSON.parse(localStorage.getItem('homeaid_reviews') || '[]');
            const storageInfo = document.getElementById('storage-info');
            
            if (reviews.length === 0) {
                storageInfo.innerHTML = '<p>No reviews found in local storage.</p>';
                return;
            }
            
            let html = `<p>Found ${reviews.length} reviews in local storage:</p><ul>`;
            reviews.forEach((review, index) => {
                html += `<li>
                    <strong>${index + 1}. ${review.name}</strong> (${review.service})<br>
                    Rating: ${review.rating} stars<br>
                    "${review.message.substring(0, 50)}${review.message.length > 50 ? '...' : ''}"
                </li>`;
            });
            html += '</ul>';
            
            storageInfo.innerHTML = html;
        }
        
        // Function to add a test review
        function addTestReview() {
            const testReview = {
                name: 'Test User ' + Math.floor(Math.random() * 100),
                email: 'test@example.com',
                service: 'Test Service',
                rating: Math.floor(Math.random() * 5) + 1,
                message: 'This is a test review added at ' + new Date().toLocaleTimeString(),
                date: new Date().toISOString()
            };
            
            // Save to local storage
            let reviews = JSON.parse(localStorage.getItem('homeaid_reviews') || '[]');
            reviews.push(testReview);
            localStorage.setItem('homeaid_reviews', JSON.stringify(reviews));
            
            // Add to display
            if (window.addNewReview) {
                window.addNewReview(
                    testReview.name,
                    testReview.service,
                    testReview.message,
                    testReview.rating
                );
            }
            
            showLocalStorage();
            alert('Test review added!');
        }
        
        // Function to clear local storage
        function clearLocalStorage() {
            if (confirm('Are you sure you want to clear all stored reviews?')) {
                localStorage.removeItem('homeaid_reviews');
                showLocalStorage();
                alert('All reviews cleared from local storage.');
                
                // Reload page to reset the display
                location.reload();
            }
        }
        
        // Form submission
        document.getElementById('testForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const name = document.getElementById('testName').value;
            const service = document.getElementById('testService').value;
            const message = document.getElementById('testMessage').value;
            
            // Create review object
            const review = {
                name: name,
                email: 'form@example.com',
                service: service,
                rating: 5,
                message: message,
                date: new Date().toISOString()
            };
            
            // Save to local storage
            let reviews = JSON.parse(localStorage.getItem('homeaid_reviews') || '[]');
            reviews.push(review);
            localStorage.setItem('homeaid_reviews', JSON.stringify(reviews));
            
            // Add to display
            if (window.addNewReview) {
                window.addNewReview(name, service, message, 5);
            }
            
            showLocalStorage();
            this.reset();
            alert('Review added successfully!');
        });
        
        // Show local storage on page load
        document.addEventListener('DOMContentLoaded', function() {
            showLocalStorage();
            
            // Load reviews from local storage
            const reviews = JSON.parse(localStorage.getItem('homeaid_reviews') || '[]');
            
            if (reviews.length > 0) {
                reviews.forEach(review => {
                    if (window.addNewReview && review.name && review.service && review.message) {
                        window.addNewReview(
                            review.name,
                            review.service,
                            review.message,
                            review.rating || 5
                        );
                    }
                });
            }
        });
    </script>
</body>
</html>
